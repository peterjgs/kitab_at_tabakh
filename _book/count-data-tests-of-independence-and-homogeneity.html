<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Count data: tests of independence and homogeneity’ | Kitab at-Tabakh</title>
  <meta name="description" content="This is a collection of miscellaneous statistics-related recipes and notes." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Count data: tests of independence and homogeneity’ | Kitab at-Tabakh" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a collection of miscellaneous statistics-related recipes and notes." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Count data: tests of independence and homogeneity’ | Kitab at-Tabakh" />
  
  <meta name="twitter:description" content="This is a collection of miscellaneous statistics-related recipes and notes." />
  

<meta name="author" content="Peter Geelan-Small" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="experimental-design.html"/>

<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Intro</a></li>
<li class="chapter" data-level="1" data-path="mawaqif.html"><a href="mawaqif.html"><i class="fa fa-check"></i><b>1</b> Mawaqif</a>
<ul>
<li class="chapter" data-level="1.1" data-path="mawaqif.html"><a href="mawaqif.html#confounders"><i class="fa fa-check"></i><b>1.1</b> Confounders</a></li>
<li class="chapter" data-level="1.2" data-path="mawaqif.html"><a href="mawaqif.html#exponential-models"><i class="fa fa-check"></i><b>1.2</b> Exponential models</a></li>
<li class="chapter" data-level="1.3" data-path="mawaqif.html"><a href="mawaqif.html#power-function"><i class="fa fa-check"></i><b>1.3</b> Power function</a></li>
<li class="chapter" data-level="1.4" data-path="mawaqif.html"><a href="mawaqif.html#roc-curves"><i class="fa fa-check"></i><b>1.4</b> ROC curves</a></li>
<li class="chapter" data-level="1.5" data-path="mawaqif.html"><a href="mawaqif.html#variable-selection"><i class="fa fa-check"></i><b>1.5</b> Variable selection</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="mawaqif.html"><a href="mawaqif.html#davison-2003-statistical-models"><i class="fa fa-check"></i><b>1.5.1</b> Davison 2003, Statistical Models</a></li>
<li class="chapter" data-level="1.5.2" data-path="mawaqif.html"><a href="mawaqif.html#faraway-2014-linear-models-with-r"><i class="fa fa-check"></i><b>1.5.2</b> Faraway 2014, Linear Models with R</a></li>
<li class="chapter" data-level="1.5.3" data-path="mawaqif.html"><a href="mawaqif.html#faraway-2016-extending-the-linear-model-with-r-2nd-ed."><i class="fa fa-check"></i><b>1.5.3</b> Faraway 2016, Extending the Linear Model with R, 2nd ed.</a></li>
<li class="chapter" data-level="1.5.4" data-path="mawaqif.html"><a href="mawaqif.html#weisberg-2014-applied-linear-regression-4th-ed."><i class="fa fa-check"></i><b>1.5.4</b> Weisberg 2014, Applied Linear Regression, 4th ed.</a></li>
<li class="chapter" data-level="1.5.5" data-path="mawaqif.html"><a href="mawaqif.html#harrell-2015-regression-modeling-strategies-2nd-ed."><i class="fa fa-check"></i><b>1.5.5</b> Harrell 2015, Regression Modeling Strategies, 2nd ed.</a></li>
<li class="chapter" data-level="1.5.6" data-path="mawaqif.html"><a href="mawaqif.html#david-wartons-draft-book-chapter-5"><i class="fa fa-check"></i><b>1.5.6</b> David Warton’s draft book, chapter 5</a></li>
<li class="chapter" data-level="1.5.7" data-path="mawaqif.html"><a href="mawaqif.html#james-et-al.-introduction-to-statistical-learning-2017-corrected-printing"><i class="fa fa-check"></i><b>1.5.7</b> James et al. Introduction to Statistical Learning, 2017 (corrected printing)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ggplot.html"><a href="ggplot.html"><i class="fa fa-check"></i><b>2</b> ggplot</a>
<ul>
<li class="chapter" data-level="2.1" data-path="ggplot.html"><a href="ggplot.html#vignettes"><i class="fa fa-check"></i><b>2.1</b> Vignettes</a></li>
<li class="chapter" data-level="2.2" data-path="ggplot.html"><a href="ggplot.html#confidence-bands"><i class="fa fa-check"></i><b>2.2</b> Confidence bands</a></li>
<li class="chapter" data-level="2.3" data-path="ggplot.html"><a href="ggplot.html#confidence-bands-fitted-models"><i class="fa fa-check"></i><b>2.3</b> Confidence bands: fitted models</a></li>
<li class="chapter" data-level="2.4" data-path="ggplot.html"><a href="ggplot.html#histogram"><i class="fa fa-check"></i><b>2.4</b> Histogram</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="ggplot.html"><a href="ggplot.html#histogram-one-vector-of-values"><i class="fa fa-check"></i><b>2.4.1</b> Histogram: one vector of values</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="ggplot.html"><a href="ggplot.html#density-plot"><i class="fa fa-check"></i><b>2.5</b> Density plot</a></li>
<li class="chapter" data-level="2.6" data-path="ggplot.html"><a href="ggplot.html#plot-structure"><i class="fa fa-check"></i><b>2.6</b> Plot structure</a></li>
<li class="chapter" data-level="2.7" data-path="ggplot.html"><a href="ggplot.html#label-legend"><i class="fa fa-check"></i><b>2.7</b> Label legend</a></li>
<li class="chapter" data-level="2.8" data-path="ggplot.html"><a href="ggplot.html#plot-title"><i class="fa fa-check"></i><b>2.8</b> Plot title</a></li>
<li class="chapter" data-level="2.9" data-path="ggplot.html"><a href="ggplot.html#three-category-colours"><i class="fa fa-check"></i><b>2.9</b> Three-category colours</a></li>
<li class="chapter" data-level="2.10" data-path="ggplot.html"><a href="ggplot.html#set-breaks-for-scale"><i class="fa fa-check"></i><b>2.10</b> Set breaks for scale</a></li>
<li class="chapter" data-level="2.11" data-path="ggplot.html"><a href="ggplot.html#display-table-to-2-d.p."><i class="fa fa-check"></i><b>2.11</b> Display table to 2 d.p.</a></li>
<li class="chapter" data-level="2.12" data-path="ggplot.html"><a href="ggplot.html#redefine-factor-levels-for-an-individual-plot"><i class="fa fa-check"></i><b>2.12</b> Redefine factor levels for an individual plot</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="r-markdown.html"><a href="r-markdown.html"><i class="fa fa-check"></i><b>3</b> R Markdown</a>
<ul>
<li class="chapter" data-level="3.1" data-path="r-markdown.html"><a href="r-markdown.html#ioslides-footnotes"><i class="fa fa-check"></i><b>3.1</b> ioslides: Footnotes</a></li>
<li class="chapter" data-level="3.2" data-path="r-markdown.html"><a href="r-markdown.html#ioslides-speakers-notes"><i class="fa fa-check"></i><b>3.2</b> ioslides: Speaker’s notes</a></li>
<li class="chapter" data-level="3.3" data-path="r-markdown.html"><a href="r-markdown.html#how-to-make-multi-line-tables"><i class="fa fa-check"></i><b>3.3</b> How to make multi-line tables</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tidyverse.html"><a href="tidyverse.html"><i class="fa fa-check"></i><b>4</b> Tidyverse</a>
<ul>
<li class="chapter" data-level="4.1" data-path="tidyverse.html"><a href="tidyverse.html#stacking-and-unstacking-data"><i class="fa fa-check"></i><b>4.1</b> Stacking and unstacking data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="linear-models.html"><a href="linear-models.html"><i class="fa fa-check"></i><b>5</b> Linear Models</a>
<ul>
<li class="chapter" data-level="5.1" data-path="linear-models.html"><a href="linear-models.html#anova-orthogonal-factors"><i class="fa fa-check"></i><b>5.1</b> ANOVA: Orthogonal factors</a></li>
<li class="chapter" data-level="5.2" data-path="linear-models.html"><a href="linear-models.html#multiple-linear-regression---conditional-and-marginal-effects"><i class="fa fa-check"></i><b>5.2</b> Multiple linear regression - conditional and marginal effects</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="linear-models.html"><a href="linear-models.html#marginal-and-conditional-interpretations"><i class="fa fa-check"></i><b>5.2.1</b> Marginal and Conditional interpretations</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="linear-models.html"><a href="linear-models.html#linear-model-with-subsampling"><i class="fa fa-check"></i><b>5.3</b> Linear model with subsampling</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="linear-models.html"><a href="linear-models.html#load-necessary-r-packages"><i class="fa fa-check"></i><b>5.3.1</b> Load necessary R packages</a></li>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#example"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="5.3.2" data-path="linear-models.html"><a href="linear-models.html#data"><i class="fa fa-check"></i><b>5.3.2</b> Data</a></li>
<li class="chapter" data-level="5.3.3" data-path="linear-models.html"><a href="linear-models.html#summary-statistics-and-plots"><i class="fa fa-check"></i><b>5.3.3</b> Summary statistics and plots</a></li>
<li class="chapter" data-level="5.3.4" data-path="linear-models.html"><a href="linear-models.html#wrong-analysis-fixed-effects-linear-model"><i class="fa fa-check"></i><b>5.3.4</b> Wrong analysis: fixed effects linear model</a></li>
<li class="chapter" data-level="5.3.5" data-path="linear-models.html"><a href="linear-models.html#right-analysis-mixed-effects-linear-model"><i class="fa fa-check"></i><b>5.3.5</b> Right analysis: mixed effects linear model</a></li>
<li class="chapter" data-level="5.3.6" data-path="linear-models.html"><a href="linear-models.html#an-aside---checking-model-assumptions"><i class="fa fa-check"></i><b>5.3.6</b> An aside - checking model assumptions</a></li>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#equal-variance-assumption"><i class="fa fa-check"></i>Equal variance assumption</a></li>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#normal-distribution-assumption"><i class="fa fa-check"></i>Normal distribution assumption</a></li>
<li class="chapter" data-level="5.3.7" data-path="linear-models.html"><a href="linear-models.html#fitted-values-and-confidence-intervals"><i class="fa fa-check"></i><b>5.3.7</b> Fitted values and confidence intervals</a></li>
<li class="chapter" data-level="5.3.8" data-path="linear-models.html"><a href="linear-models.html#another-aside---code-the-nested-structure---not-recommended"><i class="fa fa-check"></i><b>5.3.8</b> Another aside - code the nested structure - not recommended</a></li>
<li class="chapter" data-level="5.3.9" data-path="linear-models.html"><a href="linear-models.html#summary"><i class="fa fa-check"></i><b>5.3.9</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="linear-models.html"><a href="linear-models.html#marginal-means---emmeans-example"><i class="fa fa-check"></i><b>5.4</b> Marginal means - emmeans example</a></li>
<li class="chapter" data-level="5.5" data-path="linear-models.html"><a href="linear-models.html#multiple-regression-example"><i class="fa fa-check"></i><b>5.5</b> Multiple regression example</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="linear-models.html"><a href="linear-models.html#regression-model"><i class="fa fa-check"></i><b>5.5.1</b> Regression model</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="linear-models.html"><a href="linear-models.html#residual-plots---redres"><i class="fa fa-check"></i><b>5.6</b> Residual plots - redres</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html"><i class="fa fa-check"></i><b>6</b> Linear mixed models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#finding-variance-components-from-lme-models"><i class="fa fa-check"></i><b>6.1</b> Finding variance components from lme models</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="experimental-design.html"><a href="experimental-design.html"><i class="fa fa-check"></i><b>7</b> Experimental design</a>
<ul>
<li class="chapter" data-level="7.1" data-path="experimental-design.html"><a href="experimental-design.html#sample-size-by-simulation"><i class="fa fa-check"></i><b>7.1</b> Sample size by simulation</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="count-data-tests-of-independence-and-homogeneity.html"><a href="count-data-tests-of-independence-and-homogeneity.html"><i class="fa fa-check"></i><b>8</b> Count data: tests of independence and homogeneity’</a>
<ul>
<li class="chapter" data-level="8.0.1" data-path="count-data-tests-of-independence-and-homogeneity.html"><a href="count-data-tests-of-independence-and-homogeneity.html#independence"><i class="fa fa-check"></i><b>8.0.1</b> Independence</a></li>
<li class="chapter" data-level="8.0.2" data-path="count-data-tests-of-independence-and-homogeneity.html"><a href="count-data-tests-of-independence-and-homogeneity.html#homogeneity"><i class="fa fa-check"></i><b>8.0.2</b> Homogeneity</a></li>
<li class="chapter" data-level="8.0.3" data-path="count-data-tests-of-independence-and-homogeneity.html"><a href="count-data-tests-of-independence-and-homogeneity.html#comparing-two-proportions"><i class="fa fa-check"></i><b>8.0.3</b> Comparing two proportions</a></li>
<li class="chapter" data-level="8.0.4" data-path="count-data-tests-of-independence-and-homogeneity.html"><a href="count-data-tests-of-independence-and-homogeneity.html#small-counts"><i class="fa fa-check"></i><b>8.0.4</b> Small Counts</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Kitab at-Tabakh</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="count-data-tests-of-independence-and-homogeneity" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Count data: tests of independence and homogeneity’</h1>
<p>We want to compare different groups of categorical data, where the values in each category are counts.</p>
<div id="independence" class="section level3" number="8.0.1">
<h3><span class="header-section-number">8.0.1</span> Independence</h3>
<p>Suppose we want to test the hypothesis that two particular variables are operating independently in some population. To do this, we can take a <em>single sample</em> from the population and classify the individuals in the sample according to the two categorical variables. For example, we have a single sample of 556 pea plants and classify them according to shape (round or wrinkled) and colour (green or yellow). (This example is from Ekstrom, CT &amp; Sorensen, H. 2015.
<em>Introduction to Statistical Data Analysis for the Life Sciences</em>. Boca Raton: Chapman &amp; Hall/CRC Press, 2nd ed., p. 339.)</p>
<p>The specific hypothesis we’re testing here is that pea colour and shape are independent (i.e. that is the null hypothesis).</p>
<p>The data can be summarised by a 2 <span class="math inline">\(\times\)</span> 2 table (Round &amp; Wrinkled <span class="math inline">\(\times\)</span> Green &amp; Yellow):</p>
<style type="text/css">
.table {

    width: 40%;

}
</style>
<table>
<thead>
<tr class="header">
<th>Shape / Colour</th>
<th align="right">Green</th>
<th align="right">Yellow</th>
<th align="right">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Round</td>
<td align="right">108</td>
<td align="right">315</td>
<td align="right">423</td>
</tr>
<tr class="even">
<td>Wrinkled</td>
<td align="right">32</td>
<td align="right">101</td>
<td align="right">133</td>
</tr>
<tr class="odd">
<td>Total</td>
<td align="right">140</td>
<td align="right">416</td>
<td align="right">556</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="count-data-tests-of-independence-and-homogeneity.html#cb1-1" aria-hidden="true" tabindex="-1"></a>peas <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">315</span>, <span class="dv">101</span>, <span class="dv">108</span>, <span class="dv">32</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb1-2"><a href="count-data-tests-of-independence-and-homogeneity.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(peas) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Round&quot;</span>, <span class="st">&quot;Wrinkled&quot;</span>)</span>
<span id="cb1-3"><a href="count-data-tests-of-independence-and-homogeneity.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(peas) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Yellow&quot;</span>, <span class="st">&quot;Green&quot;</span>)</span>
<span id="cb1-4"><a href="count-data-tests-of-independence-and-homogeneity.html#cb1-4" aria-hidden="true" tabindex="-1"></a>peas</span>
<span id="cb1-5"><a href="count-data-tests-of-independence-and-homogeneity.html#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="count-data-tests-of-independence-and-homogeneity.html#cb1-6" aria-hidden="true" tabindex="-1"></a>peas.chisq <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(peas, <span class="at">correct =</span> F)</span>
<span id="cb1-7"><a href="count-data-tests-of-independence-and-homogeneity.html#cb1-7" aria-hidden="true" tabindex="-1"></a>peas.chisq</span>
<span id="cb1-8"><a href="count-data-tests-of-independence-and-homogeneity.html#cb1-8" aria-hidden="true" tabindex="-1"></a>chisqObsPeas <span class="ot">&lt;-</span> peas.chisq<span class="sc">$</span>statistic</span>
<span id="cb1-9"><a href="count-data-tests-of-independence-and-homogeneity.html#cb1-9" aria-hidden="true" tabindex="-1"></a>pvalPeas <span class="ot">&lt;-</span> peas.chisq<span class="sc">$</span>p.value</span></code></pre></div>
<p>The test used is a <span class="math inline">\(\chi^2\)</span> squared test, with test statistic calculated by</p>
<p><span class="math display">\[
X^2 = \sum \frac{(\mathrm{Observed} - \mathrm{Expected})^2}{\mathrm{Expected}} \; ,
\]</span>
where the test statistic is calculated over all four cells.</p>
<p>Here, <span class="math inline">\(X^2 =\)</span> 0.1163, with 1 degree of freedom, giving
<span class="math inline">\(P =\)</span> 0.733. With such a large <span class="math inline">\(P\)</span> value, we fail to reject the null hypothesis and conclude that pea colour and shape are independent.</p>
</div>
<div id="homogeneity" class="section level3" number="8.0.2">
<h3><span class="header-section-number">8.0.2</span> Homogeneity</h3>
<p>In another context, suppose we want to test the hypothesis that the survival rates of mice treated with two different sources of <em>Staphylococcus aureus</em> are the same. To do this, we run an experiment where one group of mice is injected with a standard bacterial inoculum and the other is injected with a bacterial inoculum to which penicillin has been added. Each of our experimental animals is randomly allocated to one of the groups. (This example is from Steel, RG et al. 1997. <em>Principles and Procedures of Statistics: A Biometrical Approach</em>. Boston: McGraw Hill, 3rd ed., p. 511.)</p>
<p>The specific (null) hypothesis to be tested is that the two treatments result in the same survival rate. This hypothesis is one of <em>homogeneity</em>, as we’re comparing two sub-populations, one treated with a standard inoculum and another with a penicillin-enhanced inoculum.</p>
<table>
<thead>
<tr class="header">
<th>Treatment / Status</th>
<th align="right">Alive</th>
<th align="right">Dead</th>
<th align="right">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Standard</td>
<td align="right">8</td>
<td align="right">12</td>
<td align="right">20</td>
</tr>
<tr class="even">
<td>Penicillin</td>
<td align="right">48</td>
<td align="right">62</td>
<td align="right">110</td>
</tr>
<tr class="odd">
<td>Total</td>
<td align="right">56</td>
<td align="right">74</td>
<td align="right">130</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="count-data-tests-of-independence-and-homogeneity.html#cb2-1" aria-hidden="true" tabindex="-1"></a>mice <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">48</span>, <span class="dv">12</span>, <span class="dv">62</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb2-2"><a href="count-data-tests-of-independence-and-homogeneity.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(mice) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Standard&quot;</span>, <span class="st">&quot;Penicillin&quot;</span>)</span>
<span id="cb2-3"><a href="count-data-tests-of-independence-and-homogeneity.html#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mice) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Alive&quot;</span>, <span class="st">&quot;Dead&quot;</span>)</span>
<span id="cb2-4"><a href="count-data-tests-of-independence-and-homogeneity.html#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="count-data-tests-of-independence-and-homogeneity.html#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  Pearson&#39;s chi squared test</span></span>
<span id="cb2-6"><a href="count-data-tests-of-independence-and-homogeneity.html#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="count-data-tests-of-independence-and-homogeneity.html#cb2-7" aria-hidden="true" tabindex="-1"></a>mice.chisq <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(mice, <span class="at">correct =</span> F)</span>
<span id="cb2-8"><a href="count-data-tests-of-independence-and-homogeneity.html#cb2-8" aria-hidden="true" tabindex="-1"></a>chisqObsMice <span class="ot">&lt;-</span> mice.chisq<span class="sc">$</span>statistic</span>
<span id="cb2-9"><a href="count-data-tests-of-independence-and-homogeneity.html#cb2-9" aria-hidden="true" tabindex="-1"></a>pvalMice <span class="ot">&lt;-</span> mice.chisq<span class="sc">$</span>p.value</span></code></pre></div>
<p>Here, the test statistic is calculated in the same way as for the test of independence and gives <span class="math inline">\(X^2\)</span> = 0.0913, with 1 degree of freedom, giving
<span class="math inline">\(P =\)</span> 0.763. With such a large <span class="math inline">\(P\)</span> value, we fail to reject the null hypothesis and conclude that there is no evidence to suggest a difference in the survival rates resulting from the two treatments.</p>
<p>In the first example, one sample was taken from a population and classified according to two categorical variables to determine if the variables operated independently.</p>
<p>In the second example, two random samples were used (i.e. two sub-populations) to determine whether the two sub-populations were homogeneous in relation to a particular characteristic (i.e. survival rate).</p>
<p>In the examples above, assumptions need to be met to ensure the test results are valid. The assumptions are that no <em>expected</em> values are less than 1 and no more than 20 % of expected values (i.e. here, none) are less than 5.</p>
</div>
<div id="comparing-two-proportions" class="section level3" number="8.0.3">
<h3><span class="header-section-number">8.0.3</span> Comparing two proportions</h3>
<p>In the above example of survival rates from <em>S. aureus</em> infection, the hypothesis could have been tested by directly comparing the survival rates of the two sub-populations. If the survival rate of the standard treatment group is denoted by <span class="math inline">\(p_1\)</span> and that of the penicillin treatment group by <span class="math inline">\(p_2\)</span>, the null hypothesis is
<span class="math inline">\(H_0: p_1 = p_2\)</span>. If the two proportions are equal, then the samples can be considered as coming from a single population and so, under the null hypothesis, there is a single, common value of the true survival rate. The test statistic is expressed in terms of this common value of the true proportion. The test statistic is also based on a Normal approximation and is</p>
<p><span class="math display">\[
Z = \frac{ \hat{p_1} - \hat{p_2} }{ \sqrt{ \hat{p_{\mathrm{p}}} (1 - 
\hat{p_{\mathrm{p}}}) (1 / n_{1\cdot} + 1 / n_{2\cdot})} } \; ,
\]</span>
where <span class="math inline">\(\hat{p}_i, \; i = 1, 2\)</span> are the observed survival rates for each group,
<span class="math inline">\(n_{i\cdot}, \; i = 1, 2\)</span> are the total numbers of observations in each group and
<span class="math inline">\(\hat{p_{\mathrm{p}}}\)</span> is the pooled survival rate over both groups (as it takes account of the null hypothesis); if <span class="math inline">\(n_{ij}, \; i, j = 1, 2\)</span>, are the observed values in each cell in the table and <span class="math inline">\(N\)</span> is the total number of all observations, the pooled survival rate
can be written <span class="math display">\[\hat{p_{\mathrm{p}}} = (n_{11} + n_{21}) \; / \; N \, .\]</span></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="count-data-tests-of-independence-and-homogeneity.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">##  Normal approximation</span></span>
<span id="cb3-2"><a href="count-data-tests-of-independence-and-homogeneity.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="do">##  This compares two population proportions; here, the </span></span>
<span id="cb3-3"><a href="count-data-tests-of-independence-and-homogeneity.html#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="do">##    standard and penicillin proportions</span></span>
<span id="cb3-4"><a href="count-data-tests-of-independence-and-homogeneity.html#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="count-data-tests-of-independence-and-homogeneity.html#cb3-5" aria-hidden="true" tabindex="-1"></a>mice <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">48</span>, <span class="dv">12</span>, <span class="dv">62</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb3-6"><a href="count-data-tests-of-independence-and-homogeneity.html#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="count-data-tests-of-independence-and-homogeneity.html#cb3-7" aria-hidden="true" tabindex="-1"></a>n11 <span class="ot">&lt;-</span> mice[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb3-8"><a href="count-data-tests-of-independence-and-homogeneity.html#cb3-8" aria-hidden="true" tabindex="-1"></a>n12 <span class="ot">&lt;-</span> mice[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb3-9"><a href="count-data-tests-of-independence-and-homogeneity.html#cb3-9" aria-hidden="true" tabindex="-1"></a>n21 <span class="ot">&lt;-</span> mice[<span class="dv">2</span>, <span class="dv">1</span>]</span>
<span id="cb3-10"><a href="count-data-tests-of-independence-and-homogeneity.html#cb3-10" aria-hidden="true" tabindex="-1"></a>n22 <span class="ot">&lt;-</span> mice[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb3-11"><a href="count-data-tests-of-independence-and-homogeneity.html#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="count-data-tests-of-independence-and-homogeneity.html#cb3-12" aria-hidden="true" tabindex="-1"></a>n1. <span class="ot">&lt;-</span> n11 <span class="sc">+</span> n12</span>
<span id="cb3-13"><a href="count-data-tests-of-independence-and-homogeneity.html#cb3-13" aria-hidden="true" tabindex="-1"></a>n2. <span class="ot">&lt;-</span> n21 <span class="sc">+</span> n22</span>
<span id="cb3-14"><a href="count-data-tests-of-independence-and-homogeneity.html#cb3-14" aria-hidden="true" tabindex="-1"></a>n<span class="fl">.1</span> <span class="ot">&lt;-</span> n11 <span class="sc">+</span> n21</span>
<span id="cb3-15"><a href="count-data-tests-of-independence-and-homogeneity.html#cb3-15" aria-hidden="true" tabindex="-1"></a>n<span class="fl">.2</span> <span class="ot">&lt;-</span> n12 <span class="sc">+</span> n22</span>
<span id="cb3-16"><a href="count-data-tests-of-independence-and-homogeneity.html#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="count-data-tests-of-independence-and-homogeneity.html#cb3-17" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">sum</span>(mice)</span>
<span id="cb3-18"><a href="count-data-tests-of-independence-and-homogeneity.html#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="count-data-tests-of-independence-and-homogeneity.html#cb3-19" aria-hidden="true" tabindex="-1"></a>p1.hat <span class="ot">&lt;-</span> n11 <span class="sc">/</span> n1.</span>
<span id="cb3-20"><a href="count-data-tests-of-independence-and-homogeneity.html#cb3-20" aria-hidden="true" tabindex="-1"></a>p2.hat <span class="ot">&lt;-</span> n21 <span class="sc">/</span> n2.</span>
<span id="cb3-21"><a href="count-data-tests-of-independence-and-homogeneity.html#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="count-data-tests-of-independence-and-homogeneity.html#cb3-22" aria-hidden="true" tabindex="-1"></a>pbar.hat <span class="ot">&lt;-</span> (n11 <span class="sc">+</span> n21) <span class="sc">/</span> N</span>
<span id="cb3-23"><a href="count-data-tests-of-independence-and-homogeneity.html#cb3-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-24"><a href="count-data-tests-of-independence-and-homogeneity.html#cb3-24" aria-hidden="true" tabindex="-1"></a>z.obsMice <span class="ot">&lt;-</span> (p1.hat <span class="sc">-</span> p2.hat) <span class="sc">/</span> <span class="fu">sqrt</span>( pbar.hat <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pbar.hat) <span class="sc">*</span> </span>
<span id="cb3-25"><a href="count-data-tests-of-independence-and-homogeneity.html#cb3-25" aria-hidden="true" tabindex="-1"></a>                                    (<span class="dv">1</span> <span class="sc">/</span> n1. <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> n2.) )</span>
<span id="cb3-26"><a href="count-data-tests-of-independence-and-homogeneity.html#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="do">##  z.obsMice = -0.3021</span></span>
<span id="cb3-27"><a href="count-data-tests-of-independence-and-homogeneity.html#cb3-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-28"><a href="count-data-tests-of-independence-and-homogeneity.html#cb3-28" aria-hidden="true" tabindex="-1"></a>pvalMiceZ <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pnorm</span>(z.obsMice)</span>
<span id="cb3-29"><a href="count-data-tests-of-independence-and-homogeneity.html#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="do">##  P = 0.7626</span></span>
<span id="cb3-30"><a href="count-data-tests-of-independence-and-homogeneity.html#cb3-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-31"><a href="count-data-tests-of-independence-and-homogeneity.html#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="co">#z.obsMice^2</span></span>
<span id="cb3-32"><a href="count-data-tests-of-independence-and-homogeneity.html#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="do">##  z.obs^2  = 0.09126</span></span></code></pre></div>
<p>Observed values are <span class="math inline">\(\hat{p_1} = 8 / 20, \hat{p_2} = 48 / 110,\)</span>
<span class="math inline">\(\hat{p_{\mathrm{p}}} = 56 / 130\)</span>, giving <span class="math inline">\(z =\)</span> -0.3021 and, for a two-sided test, <span class="math inline">\(P =\)</span> 0.763. This is the same result as obtained from the <span class="math inline">\(\chi^2\)</span> test above.</p>
<p>Note that the denominator in the formula for the <span class="math inline">\(Z\)</span> statistic above is the standard error of the difference of the two proportions, based on the assumption that there is a common value of the true proportion. To obtain a <em>confidence interval</em> for the difference of the two proportions, we treat the two samples simply as independent and calculate the standard error of the difference of the two proportions as
<span class="math inline">\(\sqrt{ \hat{p_1} (1 - \hat{p_1}) / n_{1\cdot} + \hat{p_2} (1 - \hat{p_2}) / n_{2\cdot} }.\)</span></p>
<p>For a significance test, the Normal approximation can be considered valid when the numbers of successes and failures in each sample are all at least 5 and for a confidence interval when they are all at least 10. (See Moore, DS et al. 2014. <em>Introduction to the Practice of Statistics</em>. New York: Freeman and Company, 8th ed., pp. 508-522, for a discussion of comparing two proportions.)</p>
</div>
<div id="small-counts" class="section level3" number="8.0.4">
<h3><span class="header-section-number">8.0.4</span> Small Counts</h3>
<p>Small observed values may lead to the assumptions for the <span class="math inline">\(\chi^2\)</span> test not being met. In that case, an alternative analysis method may be used.</p>
<p>As an example, consider an experiment investigating whether a particular fungicide is carcinogenic. Two groups of mice were used, with one group (treatment group) being fed small amounts of the fungicide via their food and the other (control group) receiving food with no additives. Mice were randomly allocated to one of the groups. After 85 weeks, all animals were sacrificed and examined for tumours. The data collected is shown below. (This example is from Ekstrom, CT &amp; Sorensen, H. 2015.
<em>Introduction to Statistical Data Analysis for the Life Sciences</em>. Boca Raton: Chapman &amp; Hall/CRC Press, 2nd ed., p. 335.)</p>
<p>This is a test of homogeneity of the control and treatment sub-populations. The null hypothesis is that the mice from the two groups have the same probability of developing tumours.</p>
<style type="text/css">
.table {

    width: 50%;

}
</style>
<table>
<thead>
<tr class="header">
<th>Treatment / Tumour</th>
<th align="center">Tumour present</th>
<th align="center">No tumour</th>
<th align="center">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Control</td>
<td align="center">5</td>
<td align="center">74</td>
<td align="center">79</td>
</tr>
<tr class="even">
<td>Treatment</td>
<td align="center">4</td>
<td align="center">12</td>
<td align="center">16</td>
</tr>
<tr class="odd">
<td>Total</td>
<td align="center">9</td>
<td align="center">86</td>
<td align="center">95</td>
</tr>
</tbody>
</table>
<p>The first approach might be the <span class="math inline">\(\chi^2\)</span> test of homogeneity.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="count-data-tests-of-independence-and-homogeneity.html#cb4-1" aria-hidden="true" tabindex="-1"></a>tumours <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">74</span>, <span class="dv">12</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb4-2"><a href="count-data-tests-of-independence-and-homogeneity.html#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(tumours) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Treatment&quot;</span>)</span>
<span id="cb4-3"><a href="count-data-tests-of-independence-and-homogeneity.html#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tumours) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Tumour present&quot;</span>, <span class="st">&quot;No tumour&quot;</span>)</span>
<span id="cb4-4"><a href="count-data-tests-of-independence-and-homogeneity.html#cb4-4" aria-hidden="true" tabindex="-1"></a>tumours</span>
<span id="cb4-5"><a href="count-data-tests-of-independence-and-homogeneity.html#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="count-data-tests-of-independence-and-homogeneity.html#cb4-6" aria-hidden="true" tabindex="-1"></a>tumours.chisq <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(tumours, <span class="at">correct =</span> F)</span>
<span id="cb4-7"><a href="count-data-tests-of-independence-and-homogeneity.html#cb4-7" aria-hidden="true" tabindex="-1"></a>tumours.chisq</span>
<span id="cb4-8"><a href="count-data-tests-of-independence-and-homogeneity.html#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="count-data-tests-of-independence-and-homogeneity.html#cb4-9" aria-hidden="true" tabindex="-1"></a>chisqObsTumours <span class="ot">&lt;-</span> tumours.chisq<span class="sc">$</span>statistic</span>
<span id="cb4-10"><a href="count-data-tests-of-independence-and-homogeneity.html#cb4-10" aria-hidden="true" tabindex="-1"></a>pvalTumours <span class="ot">&lt;-</span> tumours.chisq<span class="sc">$</span>p.value</span>
<span id="cb4-11"><a href="count-data-tests-of-independence-and-homogeneity.html#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="count-data-tests-of-independence-and-homogeneity.html#cb4-12" aria-hidden="true" tabindex="-1"></a>tumours.exp <span class="ot">&lt;-</span> tumours.chisq<span class="sc">$</span>expected</span></code></pre></div>
<p>As some observed counts are small, it’s good to check the expected values. These are shown below in parentheses next to the observed values.</p>
<table>
<thead>
<tr class="header">
<th>Treatment / Tumour</th>
<th align="center">Tumour present</th>
<th align="center">No tumour</th>
<th align="center">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Control</td>
<td align="center">5 (7.484)</td>
<td align="center">74 (71.516)</td>
<td align="center">79</td>
</tr>
<tr class="even">
<td>Treatment</td>
<td align="center">4 (1.516)</td>
<td align="center">12 (14.484)</td>
<td align="center">16</td>
</tr>
<tr class="odd">
<td>Total</td>
<td align="center">9</td>
<td align="center">86</td>
<td align="center">95</td>
</tr>
</tbody>
</table>
<p>The <span class="math inline">\(\chi^2\)</span> test here gives a test statistic of <span class="math inline">\(X^2 =\)</span> 5.4083 with <span class="math inline">\(P =\)</span> 0.02. As there is one expected value less than 5, the assumptions for the test are not met and this result cannot be accepted as valid.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="count-data-tests-of-independence-and-homogeneity.html#cb5-1" aria-hidden="true" tabindex="-1"></a>tumours <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">74</span>, <span class="dv">12</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb5-2"><a href="count-data-tests-of-independence-and-homogeneity.html#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="count-data-tests-of-independence-and-homogeneity.html#cb5-3" aria-hidden="true" tabindex="-1"></a>n11 <span class="ot">&lt;-</span> tumours[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb5-4"><a href="count-data-tests-of-independence-and-homogeneity.html#cb5-4" aria-hidden="true" tabindex="-1"></a>n12 <span class="ot">&lt;-</span> tumours[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb5-5"><a href="count-data-tests-of-independence-and-homogeneity.html#cb5-5" aria-hidden="true" tabindex="-1"></a>n21 <span class="ot">&lt;-</span> tumours[<span class="dv">2</span>, <span class="dv">1</span>]</span>
<span id="cb5-6"><a href="count-data-tests-of-independence-and-homogeneity.html#cb5-6" aria-hidden="true" tabindex="-1"></a>n22 <span class="ot">&lt;-</span> tumours[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb5-7"><a href="count-data-tests-of-independence-and-homogeneity.html#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="count-data-tests-of-independence-and-homogeneity.html#cb5-8" aria-hidden="true" tabindex="-1"></a>n1. <span class="ot">&lt;-</span> n11 <span class="sc">+</span> n12</span>
<span id="cb5-9"><a href="count-data-tests-of-independence-and-homogeneity.html#cb5-9" aria-hidden="true" tabindex="-1"></a>n2. <span class="ot">&lt;-</span> n21 <span class="sc">+</span> n22</span>
<span id="cb5-10"><a href="count-data-tests-of-independence-and-homogeneity.html#cb5-10" aria-hidden="true" tabindex="-1"></a>n<span class="fl">.1</span> <span class="ot">&lt;-</span> n11 <span class="sc">+</span> n21</span>
<span id="cb5-11"><a href="count-data-tests-of-independence-and-homogeneity.html#cb5-11" aria-hidden="true" tabindex="-1"></a>n<span class="fl">.2</span> <span class="ot">&lt;-</span> n12 <span class="sc">+</span> n22</span>
<span id="cb5-12"><a href="count-data-tests-of-independence-and-homogeneity.html#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="count-data-tests-of-independence-and-homogeneity.html#cb5-13" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">sum</span>(tumours)</span>
<span id="cb5-14"><a href="count-data-tests-of-independence-and-homogeneity.html#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="count-data-tests-of-independence-and-homogeneity.html#cb5-15" aria-hidden="true" tabindex="-1"></a>p1.hat <span class="ot">&lt;-</span> n11 <span class="sc">/</span> n1.</span>
<span id="cb5-16"><a href="count-data-tests-of-independence-and-homogeneity.html#cb5-16" aria-hidden="true" tabindex="-1"></a>p2.hat <span class="ot">&lt;-</span> n21 <span class="sc">/</span> n2.</span>
<span id="cb5-17"><a href="count-data-tests-of-independence-and-homogeneity.html#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="count-data-tests-of-independence-and-homogeneity.html#cb5-18" aria-hidden="true" tabindex="-1"></a>pbar.hat <span class="ot">&lt;-</span> (n11 <span class="sc">+</span> n21) <span class="sc">/</span> N</span>
<span id="cb5-19"><a href="count-data-tests-of-independence-and-homogeneity.html#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="count-data-tests-of-independence-and-homogeneity.html#cb5-20" aria-hidden="true" tabindex="-1"></a>z.obsTumours <span class="ot">&lt;-</span> (p1.hat <span class="sc">-</span> p2.hat) <span class="sc">/</span> <span class="fu">sqrt</span>( pbar.hat <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pbar.hat) <span class="sc">*</span> </span>
<span id="cb5-21"><a href="count-data-tests-of-independence-and-homogeneity.html#cb5-21" aria-hidden="true" tabindex="-1"></a>                                    (<span class="dv">1</span> <span class="sc">/</span> n1. <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> n2.) )</span>
<span id="cb5-22"><a href="count-data-tests-of-independence-and-homogeneity.html#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="do">##  z.obsTumours = -2.3256</span></span>
<span id="cb5-23"><a href="count-data-tests-of-independence-and-homogeneity.html#cb5-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-24"><a href="count-data-tests-of-independence-and-homogeneity.html#cb5-24" aria-hidden="true" tabindex="-1"></a>pvalTumoursZ <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pnorm</span>(z.obsTumours)</span>
<span id="cb5-25"><a href="count-data-tests-of-independence-and-homogeneity.html#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="do">##  P = 0.0200</span></span></code></pre></div>
<p>Using a Normal approximation to compare the probabilities of tumours being present in the two groups, we find the observed test statistic is
<span class="math inline">\(z =\)</span> -2.3256 with <span class="math inline">\(P =\)</span> 0.02. This gives the same result as the <span class="math inline">\(\chi^2\)</span> test.</p>
<p>A better approach, because of the small counts and the failure of the <span class="math inline">\(X^2\)</span> test assumptions (one expected value less than 5) and the Normal approximation assumptions (one count less than 5), is to use Fisher’s Exact Test.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="count-data-tests-of-independence-and-homogeneity.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">##  Fisher&#39;s Exact Test</span></span>
<span id="cb6-2"><a href="count-data-tests-of-independence-and-homogeneity.html#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="count-data-tests-of-independence-and-homogeneity.html#cb6-3" aria-hidden="true" tabindex="-1"></a>tumours <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">74</span>, <span class="dv">12</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb6-4"><a href="count-data-tests-of-independence-and-homogeneity.html#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="count-data-tests-of-independence-and-homogeneity.html#cb6-5" aria-hidden="true" tabindex="-1"></a>pvalTumoursFisher <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(tumours)<span class="sc">$</span>p.value</span></code></pre></div>
<p>There is no test statistic for this test and the <span class="math inline">\(P\)</span> value calculated is exact. This test gives <span class="math inline">\(P =\)</span> 0.041 for a two-sided test, indicating some evidence against the null hypothesis. Along with any <span class="math inline">\(P\)</span> value, it’s very useful to give an effect size.</p>
<p>All these tests can be used with tables larger than the <span class="math inline">\(2 \times 2\)</span> tables here; however, there are some practical limits to how large a table Fisher’s Exact Test can be used for.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="experimental-design.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"toc": {
"collapse": null
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
